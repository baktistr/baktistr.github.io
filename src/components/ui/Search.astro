---
// Search input component - redirects to search page
---

<div class="relative search-wrapper">
  <input
    type="search"
    placeholder="Search..."
    class="search-input w-full px-4 py-2 pl-10 rounded-lg bg-slate-900 light:bg-white border border-slate-800 light:border-slate-200 text-slate-100 light:text-slate-900 placeholder-slate-500 light:placeholder-slate-400 focus:outline-none focus:ring-2 focus:ring-cyan-400 light:focus:ring-cyan-600 focus:border-transparent"
    data-pagefind-ignore
  />
  <svg
    class="absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-slate-500 light:text-slate-400"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"
  >
    <path
      stroke-linecap="round"
      stroke-linejoin="round"
      stroke-width="2"
      d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"
    />
  </svg>
</div>

<script>
  function initSearchInputs() {
    const searchInputs = document.querySelectorAll('.search-input:not([data-initialized])');
    searchInputs.forEach((searchInput) => {
      searchInput.setAttribute('data-initialized', 'true');
      searchInput.addEventListener('keypress', function(e) {
        if (e.key === 'Enter') {
          const query = searchInput.value.trim();
          if (query) {
            window.location.href = '/search?q=' + encodeURIComponent(query);
          }
        }
      });
    });
  }

  // Initialize immediately
  initSearchInputs();

  // Re-initialize after Astro page transitions
  document.addEventListener('astro:page-load', () => {
    // Small delay to ensure DOM is updated
    setTimeout(initSearchInputs, 50);
  });

  // Also use MutationObserver for dynamic content
  const observer = new MutationObserver(() => {
    initSearchInputs();
  });
  observer.observe(document.body, { childList: true, subtree: true });
</script>
